import{u as B,r as c,i as f,o,c as a,b as t,e as r,n as m,F as p,j as g,g as L,t as h}from"./index-ade5a9fe.js";import{a as C}from"./axios-b5ee139b.js";const D={id:"todoListPage",class:"bg-half"},N={class:"conatiner todoListPage vhContainer"},T={class:"todoList_Content"},E={class:"todoList_list"},P={class:"todoList_tab"},V={class:"todoList_items"},F={key:0,class:"todoList_item"},I={class:"todoList_label"},S=["checked","onClick"],U={key:1,class:"todoList_item"},W={class:"todoList_label"},j=["checked","onClick"],M={key:2,class:"todoList_item"},R={class:"todoList_label"},q=["checked","onClick"],G={class:"todoList_statistics"},b="https://todolist-api.hexschool.io",X={__name:"TodoListView",setup(H){const y=B(),i=c(""),_=c(""),u=c([]),$=c(null);c("");const n=c("all"),x=f(()=>u.value.filter(l=>l.status===!0).length),O=f(()=>u.value.filter(l=>l.status===!0)),w=f(()=>u.value.filter(l=>l.status===!1));(async()=>{console.log("checkOnline"),_.value=!0;try{const l=document.cookie.split(";");console.log("cookies:",l),i.value=l.find(s=>s.trim().startsWith("token=")).split("=")[1],i.value&&console.log("token exists:",i.value);const e=await C.get(b+"/users/checkout",{headers:{Authorization:`${i.value}`}});console.log(e.data),$.value=e.data,alert(`${e.data.nickname} 在線上`),A(),_.value=!1}catch{alert("不再線上 即將踢人"),y.push("/"),_.value=!1}})();const A=async()=>{console.log("token:",i.value);const l=await C.get(b+"/todos/",{headers:{Authorization:`${i.value}`}});console.log(l.data),l.data.data.forEach((e,s)=>{setTimeout(()=>{console.log("todo:",e),u.value.push(e)},200*s)})},k=async(l,e)=>{console.log("id:",l);const s=`${b}/todos/${l}/toggle`;console.log(s);try{const d=await C.patch(s,{},{headers:{Authorization:`${i.value}`}});let z=null;u.value.map(v=>(v.id===l&&(v.status=!v.status,z=v.status),v)),console.log(d.data)}catch{}console.log(u.value)};return(l,e)=>(o(),a(p,null,[e[8]||(e[8]=t("h1",null,"todolis",-1)),t("div",D,[e[7]||(e[7]=t("nav",null,[t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")]),t("ul",null,[t("li",{class:"todo_sm"},[t("a",{href:"#"},[t("span",null,"王小明的代辦")])]),t("li",null,[t("a",{href:"#loginPage"},"登出")])])],-1)),t("div",N,[t("div",T,[e[6]||(e[6]=t("div",{class:"inputBox"},[t("input",{type:"text",placeholder:"請輸入待辦事項"}),t("a",{href:"#"},[t("i",{class:"fa fa-plus"})])],-1)),t("div",E,[t("ul",P,[t("li",null,[t("a",{href:"#",onClick:e[0]||(e[0]=r(s=>n.value="all",["prevent"])),class:m({active:n.value==="all"})},"全部",2)]),t("li",null,[t("a",{href:"#",onClick:e[1]||(e[1]=r(s=>n.value="uncompleted",["prevent"])),class:m({active:n.value==="uncompleted"})},"待完成",2)]),t("li",null,[t("a",{href:"#",onClick:e[2]||(e[2]=r(s=>n.value="completed",["prevent"])),class:m({active:n.value==="completed"})},"已完成",2)])]),t("div",V,[n.value==="all"?(o(),a("ul",F,[(o(!0),a(p,null,g(u.value,s=>(o(),a("li",null,[t("label",I,[t("input",{class:"todoList_input",type:"checkbox",checked:s.status,onClick:r(d=>k(s.id),["prevent"])},null,8,S),t("span",null,h(s.content),1)]),e[3]||(e[3]=t("a",{href:"#"},[t("i",{class:"fa fa-times"})],-1))]))),256))])):L("",!0),n.value==="uncompleted"?(o(),a("ul",U,[(o(!0),a(p,null,g(w.value,s=>(o(),a("li",null,[t("label",W,[t("input",{class:"todoList_input",type:"checkbox",checked:s.status,onClick:r(d=>k(s.id),["prevent"])},null,8,j),t("span",null,h(s.content),1)]),e[4]||(e[4]=t("a",{href:"#"},[t("i",{class:"fa fa-times"})],-1))]))),256))])):L("",!0),n.value==="completed"?(o(),a("ul",M,[(o(!0),a(p,null,g(O.value,s=>(o(),a("li",null,[t("label",R,[t("input",{class:"todoList_input",type:"checkbox",checked:s.status,onClick:r(d=>k(s.id),["prevent"])},null,8,q),t("span",null,h(s.content),1)]),e[5]||(e[5]=t("a",{href:"#"},[t("i",{class:"fa fa-times"})],-1))]))),256))])):L("",!0),t("div",G,[t("p",null,h(x.value)+" 個已完成項目",1)])])])])])])],64))}};export{X as default};
