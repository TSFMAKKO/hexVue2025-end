import{i as h,u as L,o as i,c as r,a as e,b as p,_ as V,d as $,r as n,p as D,e as F,f as c,w,g as N,h as y,v as b,t as g,F as S,j as U}from"./index-edf991e3.js";import{a as j}from"./axios-b5ee139b.js";const B={key:0,id:"loading-overlay",class:"d-flex justify-content-center align-items-center"},E={__name:"isLoading",setup(k){const d=h("isLoading");return console.log("isLoading:",d.value),(l,t)=>L(d)?(i(),r("div",B,t[0]||(t[0]=[e("div",{class:"apple-spinner"},[e("div"),e("div"),e("div"),e("div"),e("div"),e("div"),e("div"),e("div"),e("div"),e("div"),e("div"),e("div")],-1)]))):p("",!0)}};const P={id:"loginPage",class:"bg-yellow"},T={class:"conatiner loginPage vhContainer"},I={class:"side"},M={key:0,class:"error-message"},A={key:1,class:"error-message"},R={key:2,class:"error-message"},q="https://todolist-api.hexschool.io",z={__name:"LoginView",setup(k){const d=$(),l=n("example333@gmail.com"),t=n("example"),a=n({email:"",password:"",login:""}),u=n(!1),v=n("");D("isLoading",u);const _=(o,s)=>o.value?(a.value[o.key]="",!0):(a.value[o.key]=s,!1),x=()=>{a.value={};const o=_({value:l.value,key:"email"},"請填寫 email"),s=_({value:t.value,key:"password"},"請填寫密碼");return o&&s},C=async()=>{if(x()){console.log("登入資訊:",{email:l.value,password:t.value}),console.log("login"),u.value=!0;try{const o=await j.post(q+"/users/sign_in",{email:l.value,password:t.value});console.log("res:",o.data),v.value=o.data.token,console.log(v.value),alert(`${o.data.nickname} 登入成功`),document.cookie=`token=${v.value}; expires=${new Date(Date.now()+3600*1e3).toUTCString()}; path=/`,u.value=!1,d.push("/todos")}catch(o){alert(`登入失敗${o.response.data.message}`),console.error("登入失敗:",o),u.value=!1,o.response&&o.response.data?a.value.login=o.response.data.message||"登入失敗，請稍後再試":a.value.login="登入失敗，請稍後再試";return}}};return(o,s)=>{const f=F("router-link");return i(),r(S,null,[e("div",null,[e("div",P,[e("div",T,[e("div",I,[c(f,{to:"/"},{default:w(()=>s[2]||(s[2]=[e("img",{class:"logoImg",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/logo.png",alt:"待辦事項"},null,-1)])),_:1,__:[2]}),s[3]||(s[3]=e("img",{class:"d-m-n",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/img.png",alt:"工作圖片"},null,-1))]),e("div",null,[e("form",{class:"formControls",onSubmit:N(C,["prevent"])},[s[5]||(s[5]=e("h2",{class:"formControls_txt"},"最實用的線上代辦事項服務",-1)),s[6]||(s[6]=e("label",{class:"formControls_label",for:"email"},"Email",-1)),y(e("input",{class:"formControls_input",type:"email",id:"email","onUpdate:modelValue":s[0]||(s[0]=m=>l.value=m),placeholder:"請輸入 email"},null,512),[[b,l.value]]),a.value.email?(i(),r("span",M,g(a.value.email),1)):p("",!0),s[7]||(s[7]=e("label",{class:"formControls_label",for:"pwd"},"密碼",-1)),y(e("input",{class:"formControls_input",type:"password",id:"pwd","onUpdate:modelValue":s[1]||(s[1]=m=>t.value=m),placeholder:"請輸入密碼"},null,512),[[b,t.value]]),a.value.password?(i(),r("span",A,g(a.value.password),1)):p("",!0),a.value.login?(i(),r("span",R,g(a.value.login),1)):p("",!0),s[8]||(s[8]=e("button",{type:"submit",class:"formControls_btnSubmit"},"登入",-1)),c(f,{to:"/signup",class:"formControls_btnLink"},{default:w(()=>s[4]||(s[4]=[U("註冊帳號",-1)])),_:1,__:[4]})],32)])])])]),c(E)],64)}}},J=V(z,[["__scopeId","data-v-dae78b6d"]]);export{J as default};
